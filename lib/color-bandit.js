!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("canvas-everywhere")):"function"==typeof define&&define.amd?define("ColorBandit",["canvas-everywhere"],e):"object"==typeof exports?exports.ColorBandit=e(require("canvas-everywhere")):t.ColorBandit=e(t["canvas-everywhere"])}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;(e<2||e>256)&&(e=10),n<1&&(n=10);for(var r,o,u,i,a=new s.default(t),c=a.getImageData(),l=c.data,h=a.getPixelCount(),v=[],p=0;p<h;p+=n)r=4*p,o=l[r+0],u=l[r+1],i=l[r+2],l[r+3]>=125&&(o>250&&u>250&&i>250||v.push([o,u,i]));var g=(0,f.quantize)(v,e);return g?g.palette():null}/*
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 * License
 * -------
 * Copyright 2011, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 *
 * @license
 */
function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(0,a.loadImage)(t).then(function(t){return r(t,e,n)})}function u(t,e){return r(t,5,e)[0]}function i(t,e){return(0,a.loadImage)(t).then(function(t){return r(t,5,e)[0]})}Object.defineProperty(e,"__esModule",{value:!0}),e.getPalette=r,e.getPaletteFromUrl=o,e.getColor=u,e.getColorFromUrl=i;var a=n(0),c=n(2),s=function(t){return t&&t.__esModule?t:{default:t}}(c),f=n(3)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(0),i=function(){function t(e){r(this,t);var n=e.width,o=e.height;this.canvas=(0,u.createCanvas)(n,o),this.context=this.canvas.getContext("2d"),this.width=n,this.height=o,this.context.drawImage(e,0,0,this.width,this.height)}return o(t,[{key:"clear",value:function(){this.context.clearRect(0,0,this.width,this.height)}},{key:"update",value:function(t){this.context.putImageData(t,0,0)}},{key:"getPixelCount",value:function(){return this.width*this.height}},{key:"getImageData",value:function(){return this.context.getImageData(0,0,this.width,this.height)}}]),t}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,n){return(t<<2*l)+(e<<l)+n}function u(t){var e,n,r,u,i=1<<3*l,a=new Array(i);return t.forEach(function(t){n=t[0]>>h,r=t[1]>>h,u=t[2]>>h,e=o(n,r,u),a[e]=(a[e]||0)+1}),a}function i(t,e){var n,r,o,u=1e6,i=0,a=1e6,c=0,s=1e6,f=0;return t.forEach(function(t){n=t[0]>>h,r=t[1]>>h,o=t[2]>>h,n<u?u=n:n>i&&(i=n),r<a?a=r:r>c&&(c=r),o<s?s=o:o>f&&(f=o)}),new b(u,i,a,c,s,f,e)}function a(t,e){function n(t){var n,r,o,u,i,a=t+"1",s=t+"2",f=0;for(c=e[a];c<=e[s];c++)if(g[c]>p/2){for(o=e.copy(),u=e.copy(),n=c-e[a],r=e[s]-c,i=n<=r?Math.min(e[s]-1,~~(c+r/2)):Math.max(e[a],~~(c-1-n/2));!g[i];)i++;for(f=b[i];!f&&g[i-1];)f=b[--i];return o[s]=i,u[a]=o[s]+1,[o,u]}}if(e.count()){var r=e.r2-e.r1+1,u=e.g2-e.g1+1,i=e.b2-e.b1+1,a=f.max([r,u,i]);if(1==e.count())return[e.copy()];var c,s,l,h,v,p=0,g=[],b=[];if(a==r)for(c=e.r1;c<=e.r2;c++){for(h=0,s=e.g1;s<=e.g2;s++)for(l=e.b1;l<=e.b2;l++)v=o(c,s,l),h+=t[v]||0;p+=h,g[c]=p}else if(a==u)for(c=e.g1;c<=e.g2;c++){for(h=0,s=e.r1;s<=e.r2;s++)for(l=e.b1;l<=e.b2;l++)v=o(s,c,l),h+=t[v]||0;p+=h,g[c]=p}else for(c=e.b1;c<=e.b2;c++){for(h=0,s=e.r1;s<=e.r2;s++)for(l=e.g1;l<=e.g2;l++)v=o(s,l,c),h+=t[v]||0;p+=h,g[c]=p}return g.forEach(function(t,e){b[e]=p-t}),n(a==r?"r":a==u?"g":"b")}}function c(t,e){function n(t,e){for(var n,o=1,u=0;u<v;)if(n=t.pop(),n.count()){var i=a(r,n),c=i[0],s=i[1];if(!c)return;if(t.push(c),s&&(t.push(s),o++),o>=e)return;if(u++>v)return}else t.push(n),u++}if(!t.length||e<2||e>256)return!1;var r=u(t),o=0;r.forEach(function(){o++});var c=i(t,r),s=new g(function(t,e){return f.naturalOrder(t.count(),e.count())});s.push(c),n(s,p*e);for(var l=new g(function(t,e){return f.naturalOrder(t.count()*t.volume(),e.count()*e.volume())});s.size();)l.push(s.pop());n(l,e-l.size());for(var h=new d;l.size();)h.push(l.pop());return h}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.quantize=c;/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 * @license
 */
/*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 * @license
 */
var f={map:function(t,e){var n={};return e?t.map(function(t,r){return n.index=r,e.call(n,t)}):t.slice()},naturalOrder:function(t,e){return t<e?-1:t>e?1:0},sum:function(t,e){var n={};return t.reduce(e?function(t,r,o){return n.index=o,t+e.call(n,r)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?f.map(t,e):t)}},l=5,h=8-l,v=1e3,p=.75,g=function(){function t(e){r(this,t),this.comparator=e,this.contents=[],this.sorted=!1}return s(t,[{key:"sort",value:function(){this.contents.sort(this.comparator),this.sorted=!0}},{key:"push",value:function(t){this.contents.push(t),this.sorted=!1}},{key:"peek",value:function(t){return this.sorted||this.sort(),void 0===t&&(t=this.contents.length-1),this.contents[t]}},{key:"pop",value:function(){return this.sorted||this.sort(),this.contents.pop()}},{key:"size",value:function(){return this.contents.length}},{key:"map",value:function(t){return this.contents.map(t)}},{key:"debug",value:function(){return this.sorted||this.sort(),this.contents}}]),t}(),b=function(){function t(e,n,o,u,i,a,c){r(this,t),this.r1=e,this.r2=n,this.g1=o,this.g2=u,this.b1=i,this.b2=a,this.histo=c}return s(t,[{key:"volume",value:function(t){var e=this;return e._volume&&!t||(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume}},{key:"count",value:function(t){var e=this,n=e.histo;if(!e._count_set||t){var r,u,i,a,c=0;for(u=e.r1;u<=e.r2;u++)for(i=e.g1;i<=e.g2;i++)for(a=e.b1;a<=e.b2;a++)r=o(u,i,a),c+=n[r]||0;e._count=c,e._count_set=!0}return e._count}},{key:"copy",value:function(){var e=this;return new t(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)}},{key:"avg",value:function(t){var e=this,n=e.histo;if(!e._avg||t){var r,u,i,a,c,s=0,f=1<<8-l,h=0,v=0,p=0;for(u=e.r1;u<=e.r2;u++)for(i=e.g1;i<=e.g2;i++)for(a=e.b1;a<=e.b2;a++)c=o(u,i,a),r=n[c]||0,s+=r,h+=r*(u+.5)*f,v+=r*(i+.5)*f,p+=r*(a+.5)*f;e._avg=s?[~~(h/s),~~(v/s),~~(p/s)]:[~~(f*(e.r1+e.r2+1)/2),~~(f*(e.g1+e.g2+1)/2),~~(f*(e.b1+e.b2+1)/2)]}return e._avg}},{key:"contains",value:function(t){var e=this,n=t[0]>>h;return gval=t[1]>>h,bval=t[2]>>h,n>=e.r1&&n<=e.r2&&gval>=e.g1&&gval<=e.g2&&bval>=e.b1&&bval<=e.b2}}]),t}(),d=function(){function t(){r(this,t),this.vboxes=new g(function(t,e){return f.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())})}return s(t,[{key:"push",value:function(t){this.vboxes.push({vbox:t,color:t.avg()})}},{key:"palette",value:function(){return this.vboxes.map(function(t){return t.color})}},{key:"size",value:function(){return this.vboxes.size()}},{key:"map",value:function(t){for(var e=this.vboxes,n=0;n<e.size();n++)if(e.peek(n).vbox.contains(t))return e.peek(n).color;return this.nearest(t)}},{key:"nearest",value:function(t){for(var e,n,r,o=this.vboxes,u=0;u<o.size();u++)((n=Math.sqrt(Math.pow(t[0]-o.peek(u).color[0],2)+Math.pow(t[1]-o.peek(u).color[1],2)+Math.pow(t[2]-o.peek(u).color[2],2)))<e||void 0===e)&&(e=n,r=o.peek(u).color);return r}},{key:"forcebw",value:function(){var t=this.vboxes;t.sort(function(t,e){return f.naturalOrder(f.sum(t.color),f.sum(e.color))});var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,r=t[n].color;r[0]>251&&r[1]>251&&r[2]>251&&(t[n].color=[255,255,255])}}]),t}()}])});